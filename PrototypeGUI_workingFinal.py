# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'GraphingGUI.ui'
#
# Created by: PyQt5 UI code generator 5.15.9
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.

import sys
import numpy as np
import multiprocessing
import paho.mqtt.client as mqtt
from PyQt5.QtGui import * 
import PyQt5.QtWidgets as qt
from PyQt5.QtCore import *
from matplotlib.backends.backend_qt5agg import (FigureCanvas, NavigationToolbar2QT as NavigationToolbar)
from matplotlib.figure import Figure
import matplotlib.pyplot as plt
import matplotlib.patches as mpatches
from PyQt5 import QtCore, QtGui, QtWidgets


class Ui_GUIWindow(object):
    def __init__(self, data_queue):
        super().__init__()
        self.data_queue = data_queue
        self.setupUi(MainWindow)

        def on_connect(client, userdata, flags, rc):
            # Subscribes to the user input inside the input_mqtt_topic
            print("Connected to topic: ac_phys/workxp/live_signals")
            client.subscribe("ac_phys/workxp/live_signals")

        def on_message(client, userdata, msg):
            msg_byte = msg.payload
            msg_array = np.frombuffer(msg_byte, dtype=float, count=-1, offset=0)
            msg_full = np.reshape(msg_array, (40, 2200))
            # when we receive a message (on_message), we run the update_plot function, 
            # which plots the data as soon as it receives a message.
            print(msg_full)
            self.waterfall(msg_full)
            # self.update_plot(np.array(msg_full))
            

        def on_disconnect(client, userdata, rc):
            if rc != 0:
                print("Unexpected disconnection")
            else:
                print("Disconnected")

            # self.button_connect.clicked.disconnect()
            # self.input_mqtt_topic.setEnabled(True)


        self.client = mqtt.Client()
        self.client.on_connect = on_connect
        self.client.on_message = on_message
        self.client.on_disconnect = on_disconnect
        self.client.connect("130.246.57.45", 8883, 60)
        self.client.loop_start()

        #self.button_connect.clicked.connect(self.connect)

    def setupUi(self, GUIWindow):
        GUIWindow.setObjectName("GUIWindow")
        GUIWindow.resize(1223, 848)
        self.centralwidget = QtWidgets.QWidget(GUIWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.verticalLayoutWidget = QtWidgets.QWidget(self.centralwidget)
        self.verticalLayoutWidget.setGeometry(QtCore.QRect(9, 159, 681, 631))
        self.verticalLayoutWidget.setObjectName("verticalLayoutWidget")
        self.verticalLayout = QtWidgets.QVBoxLayout(self.verticalLayoutWidget)
        self.verticalLayout.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout.setObjectName("verticalLayout")
        self.fig = Figure(figsize = [9, 3])
        self.static_canvas = FigureCanvas(self.fig)

        self.ProtonNo = QtWidgets.QLCDNumber(self.centralwidget)
        self.ProtonNo.setGeometry(QtCore.QRect(10, 70, 121, 71))
        self.ProtonNo.setObjectName("ProtonNo")
        self.VoltageNo = QtWidgets.QLCDNumber(self.centralwidget)
        self.VoltageNo.setGeometry(QtCore.QRect(190, 70, 121, 71))
        self.VoltageNo.setObjectName("VoltageNo")
        self.CoulombsNo = QtWidgets.QLCDNumber(self.centralwidget)
        self.CoulombsNo.setGeometry(QtCore.QRect(380, 70, 121, 71))
        self.CoulombsNo.setObjectName("CoulombsNo")
        self.EnergyNo = QtWidgets.QLCDNumber(self.centralwidget)
        self.EnergyNo.setGeometry(QtCore.QRect(570, 70, 121, 71))
        self.EnergyNo.setObjectName("EnergyNo")
        self.ProtonPN = QtWidgets.QLabel(self.centralwidget)
        self.ProtonPN.setGeometry(QtCore.QRect(10, 0, 121, 71))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        font.setBold(False)
        font.setUnderline(True)
        font.setWeight(50)
        self.ProtonPN.setFont(font)
        self.ProtonPN.setAlignment(QtCore.Qt.AlignCenter)
        self.ProtonPN.setObjectName("ProtonPN")
        self.VoltageMeV = QtWidgets.QLabel(self.centralwidget)
        self.VoltageMeV.setGeometry(QtCore.QRect(190, 0, 121, 71))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        font.setPointSize(8)
        font.setBold(False)
        font.setUnderline(True)
        font.setWeight(50)
        self.VoltageMeV.setFont(font)
        self.VoltageMeV.setAlignment(QtCore.Qt.AlignCenter)
        self.VoltageMeV.setObjectName("VoltageMeV")
        self.CoulombsC = QtWidgets.QLabel(self.centralwidget)
        self.CoulombsC.setGeometry(QtCore.QRect(380, 0, 121, 71))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        font.setPointSize(8)
        font.setBold(False)
        font.setUnderline(True)
        font.setWeight(50)
        self.CoulombsC.setFont(font)
        self.CoulombsC.setAlignment(QtCore.Qt.AlignCenter)
        self.CoulombsC.setObjectName("CoulombsC")
        self.EnergyJ = QtWidgets.QLabel(self.centralwidget)
        self.EnergyJ.setGeometry(QtCore.QRect(570, 0, 121, 71))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        font.setPointSize(8)
        font.setBold(False)
        font.setUnderline(True)
        font.setWeight(50)
        self.EnergyJ.setFont(font)
        self.EnergyJ.setAlignment(QtCore.Qt.AlignCenter)
        self.EnergyJ.setObjectName("EnergyJ")
        self.R0Frame = QtWidgets.QFrame(self.centralwidget)
        self.R0Frame.setGeometry(QtCore.QRect(720, 200, 80, 80))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R0Frame.setFont(font)
        self.R0Frame.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.R0Frame.setFrameShadow(QtWidgets.QFrame.Raised)
        self.R0Frame.setObjectName("R0Frame")
        self.R0BLM1 = QtWidgets.QCheckBox(self.R0Frame)
        self.R0BLM1.setGeometry(QtCore.QRect(0, 10, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R0BLM1.setFont(font)
        self.R0BLM1.setChecked(True)
        self.R0BLM1.setObjectName("R0BLM1")
        self.R0BLM3 = QtWidgets.QCheckBox(self.R0Frame)
        self.R0BLM3.setGeometry(QtCore.QRect(0, 30, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R0BLM3.setFont(font)
        self.R0BLM3.setChecked(True)
        self.R0BLM3.setObjectName("R0BLM3")
        self.R0BLM4 = QtWidgets.QCheckBox(self.R0Frame)
        self.R0BLM4.setGeometry(QtCore.QRect(0, 50, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R0BLM4.setFont(font)
        self.R0BLM4.setChecked(True)
        self.R0BLM4.setObjectName("R0BLM4")
        self.R0 = QtWidgets.QCheckBox(self.centralwidget)
        self.R0.setGeometry(QtCore.QRect(720, 180, 80, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R0.setFont(font)
        self.R0.setChecked(True)
        self.R0.setObjectName("R0")
        self.R1 = QtWidgets.QCheckBox(self.centralwidget)
        self.R1.setGeometry(QtCore.QRect(820, 180, 80, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R1.setFont(font)
        self.R1.setChecked(True)
        self.R1.setObjectName("R1")
        self.R1Frame = QtWidgets.QFrame(self.centralwidget)
        self.R1Frame.setGeometry(QtCore.QRect(820, 200, 80, 100))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R1Frame.setFont(font)
        self.R1Frame.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.R1Frame.setFrameShadow(QtWidgets.QFrame.Raised)
        self.R1Frame.setObjectName("R1Frame")
        self.R1BLM1 = QtWidgets.QCheckBox(self.R1Frame)
        self.R1BLM1.setGeometry(QtCore.QRect(0, 10, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R1BLM1.setFont(font)
        self.R1BLM1.setChecked(True)
        self.R1BLM1.setObjectName("R1BLM1")
        self.R1BLM2 = QtWidgets.QCheckBox(self.R1Frame)
        self.R1BLM2.setGeometry(QtCore.QRect(0, 30, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R1BLM2.setFont(font)
        self.R1BLM2.setChecked(True)
        self.R1BLM2.setObjectName("R1BLM2")
        self.R1BLM3 = QtWidgets.QCheckBox(self.R1Frame)
        self.R1BLM3.setGeometry(QtCore.QRect(0, 50, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R1BLM3.setFont(font)
        self.R1BLM3.setChecked(True)
        self.R1BLM3.setObjectName("R1BLM3")
        self.R1BLM4 = QtWidgets.QCheckBox(self.R1Frame)
        self.R1BLM4.setGeometry(QtCore.QRect(0, 70, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R1BLM4.setFont(font)
        self.R1BLM4.setChecked(True)
        self.R1BLM4.setObjectName("R1BLM4")
        self.R2Frame = QtWidgets.QFrame(self.centralwidget)
        self.R2Frame.setGeometry(QtCore.QRect(920, 200, 80, 100))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R2Frame.setFont(font)
        self.R2Frame.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.R2Frame.setFrameShadow(QtWidgets.QFrame.Raised)
        self.R2Frame.setObjectName("R2Frame")
        self.R2BLM1 = QtWidgets.QCheckBox(self.R2Frame)
        self.R2BLM1.setGeometry(QtCore.QRect(0, 10, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R2BLM1.setFont(font)
        self.R2BLM1.setChecked(True)
        self.R2BLM1.setObjectName("R2BLM1")
        self.R2BLM2 = QtWidgets.QCheckBox(self.R2Frame)
        self.R2BLM2.setGeometry(QtCore.QRect(0, 30, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R2BLM2.setFont(font)
        self.R2BLM2.setChecked(True)
        self.R2BLM2.setObjectName("R2BLM2")
        self.R2BLM3 = QtWidgets.QCheckBox(self.R2Frame)
        self.R2BLM3.setGeometry(QtCore.QRect(0, 50, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R2BLM3.setFont(font)
        self.R2BLM3.setChecked(True)
        self.R2BLM3.setObjectName("R2BLM3")
        self.R2BLM4 = QtWidgets.QCheckBox(self.R2Frame)
        self.R2BLM4.setGeometry(QtCore.QRect(0, 70, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R2BLM4.setFont(font)
        self.R2BLM4.setChecked(True)
        self.R2BLM4.setObjectName("R2BLM4")
        self.R2 = QtWidgets.QCheckBox(self.centralwidget)
        self.R2.setGeometry(QtCore.QRect(920, 180, 80, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R2.setFont(font)
        self.R2.setChecked(True)
        self.R2.setObjectName("R2")
        self.R3 = QtWidgets.QCheckBox(self.centralwidget)
        self.R3.setGeometry(QtCore.QRect(1020, 180, 80, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R3.setFont(font)
        self.R3.setChecked(True)
        self.R3.setObjectName("R3")
        self.R4 = QtWidgets.QCheckBox(self.centralwidget)
        self.R4.setGeometry(QtCore.QRect(1130, 180, 80, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R4.setFont(font)
        self.R4.setChecked(True)
        self.R4.setObjectName("R4")
        self.R5 = QtWidgets.QCheckBox(self.centralwidget)
        self.R5.setGeometry(QtCore.QRect(720, 310, 80, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R5.setFont(font)
        self.R5.setChecked(True)
        self.R5.setObjectName("R5")
        self.R6 = QtWidgets.QCheckBox(self.centralwidget)
        self.R6.setGeometry(QtCore.QRect(820, 310, 80, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R6.setFont(font)
        self.R6.setChecked(True)
        self.R6.setObjectName("R6")
        self.R7 = QtWidgets.QCheckBox(self.centralwidget)
        self.R7.setGeometry(QtCore.QRect(920, 310, 80, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R7.setFont(font)
        self.R7.setChecked(True)
        self.R7.setObjectName("R7")
        self.R8 = QtWidgets.QCheckBox(self.centralwidget)
        self.R8.setGeometry(QtCore.QRect(1020, 310, 80, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R8.setFont(font)
        self.R8.setChecked(True)
        self.R8.setObjectName("R8")
        self.R9 = QtWidgets.QCheckBox(self.centralwidget)
        self.R9.setGeometry(QtCore.QRect(1130, 310, 80, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R9.setFont(font)
        self.R9.setChecked(True)
        self.R9.setObjectName("R9")
        self.R3Frame = QtWidgets.QFrame(self.centralwidget)
        self.R3Frame.setGeometry(QtCore.QRect(1020, 200, 80, 100))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R3Frame.setFont(font)
        self.R3Frame.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.R3Frame.setFrameShadow(QtWidgets.QFrame.Raised)
        self.R3Frame.setObjectName("R3Frame")
        self.R3BLM3 = QtWidgets.QCheckBox(self.R3Frame)
        self.R3BLM3.setGeometry(QtCore.QRect(0, 50, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R3BLM3.setFont(font)
        self.R3BLM3.setChecked(True)
        self.R3BLM3.setObjectName("R3BLM3")
        self.R3BLM2 = QtWidgets.QCheckBox(self.R3Frame)
        self.R3BLM2.setGeometry(QtCore.QRect(0, 30, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R3BLM2.setFont(font)
        self.R3BLM2.setChecked(True)
        self.R3BLM2.setObjectName("R3BLM2")
        self.R3BLM1 = QtWidgets.QCheckBox(self.R3Frame)
        self.R3BLM1.setGeometry(QtCore.QRect(0, 10, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R3BLM1.setFont(font)
        self.R3BLM1.setChecked(True)
        self.R3BLM1.setObjectName("R3BLM1")
        self.R3BLM4 = QtWidgets.QCheckBox(self.R3Frame)
        self.R3BLM4.setGeometry(QtCore.QRect(0, 70, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R3BLM4.setFont(font)
        self.R3BLM4.setChecked(True)
        self.R3BLM4.setObjectName("R3BLM4")
        self.R4Frame = QtWidgets.QFrame(self.centralwidget)
        self.R4Frame.setGeometry(QtCore.QRect(1130, 200, 80, 100))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R4Frame.setFont(font)
        self.R4Frame.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.R4Frame.setFrameShadow(QtWidgets.QFrame.Raised)
        self.R4Frame.setObjectName("R4Frame")
        self.R4BLM3 = QtWidgets.QCheckBox(self.R4Frame)
        self.R4BLM3.setGeometry(QtCore.QRect(0, 50, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R4BLM3.setFont(font)
        self.R4BLM3.setChecked(True)
        self.R4BLM3.setObjectName("R4BLM3")
        self.R4BLM4 = QtWidgets.QCheckBox(self.R4Frame)
        self.R4BLM4.setGeometry(QtCore.QRect(0, 70, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R4BLM4.setFont(font)
        self.R4BLM4.setChecked(True)
        self.R4BLM4.setObjectName("R4BLM4")
        self.R4BLM1 = QtWidgets.QCheckBox(self.R4Frame)
        self.R4BLM1.setGeometry(QtCore.QRect(0, 10, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R4BLM1.setFont(font)
        self.R4BLM1.setChecked(True)
        self.R4BLM1.setObjectName("R4BLM1")
        self.R4BLM2 = QtWidgets.QCheckBox(self.R4Frame)
        self.R4BLM2.setGeometry(QtCore.QRect(0, 30, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R4BLM2.setFont(font)
        self.R4BLM2.setChecked(True)
        self.R4BLM2.setObjectName("R4BLM2")
        self.R5Frame = QtWidgets.QFrame(self.centralwidget)
        self.R5Frame.setGeometry(QtCore.QRect(720, 330, 80, 100))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R5Frame.setFont(font)
        self.R5Frame.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.R5Frame.setFrameShadow(QtWidgets.QFrame.Raised)
        self.R5Frame.setObjectName("R5Frame")
        self.R5BLM3 = QtWidgets.QCheckBox(self.R5Frame)
        self.R5BLM3.setGeometry(QtCore.QRect(0, 50, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R5BLM3.setFont(font)
        self.R5BLM3.setChecked(True)
        self.R5BLM3.setObjectName("R5BLM3")
        self.R5BLM4 = QtWidgets.QCheckBox(self.R5Frame)
        self.R5BLM4.setGeometry(QtCore.QRect(0, 70, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R5BLM4.setFont(font)
        self.R5BLM4.setChecked(True)
        self.R5BLM4.setObjectName("R5BLM4")
        self.R5BLM2 = QtWidgets.QCheckBox(self.R5Frame)
        self.R5BLM2.setGeometry(QtCore.QRect(0, 30, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R5BLM2.setFont(font)
        self.R5BLM2.setChecked(True)
        self.R5BLM2.setObjectName("R5BLM2")
        self.R5BLM1 = QtWidgets.QCheckBox(self.R5Frame)
        self.R5BLM1.setGeometry(QtCore.QRect(0, 10, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R5BLM1.setFont(font)
        self.R5BLM1.setChecked(True)
        self.R5BLM1.setObjectName("R5BLM1")
        self.R6Frame = QtWidgets.QFrame(self.centralwidget)
        self.R6Frame.setGeometry(QtCore.QRect(820, 330, 80, 100))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R6Frame.setFont(font)
        self.R6Frame.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.R6Frame.setFrameShadow(QtWidgets.QFrame.Raised)
        self.R6Frame.setObjectName("R6Frame")
        self.R6BLM3 = QtWidgets.QCheckBox(self.R6Frame)
        self.R6BLM3.setGeometry(QtCore.QRect(0, 50, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R6BLM3.setFont(font)
        self.R6BLM3.setChecked(True)
        self.R6BLM3.setObjectName("R6BLM3")
        self.R6BLM2 = QtWidgets.QCheckBox(self.R6Frame)
        self.R6BLM2.setGeometry(QtCore.QRect(0, 30, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R6BLM2.setFont(font)
        self.R6BLM2.setChecked(True)
        self.R6BLM2.setObjectName("R6BLM2")
        self.R6BLM1 = QtWidgets.QCheckBox(self.R6Frame)
        self.R6BLM1.setGeometry(QtCore.QRect(0, 10, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R6BLM1.setFont(font)
        self.R6BLM1.setChecked(True)
        self.R6BLM1.setObjectName("R6BLM1")
        self.R6BLM4 = QtWidgets.QCheckBox(self.R6Frame)
        self.R6BLM4.setGeometry(QtCore.QRect(0, 70, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R6BLM4.setFont(font)
        self.R6BLM4.setChecked(True)
        self.R6BLM4.setObjectName("R6BLM4")
        self.R7Frame = QtWidgets.QFrame(self.centralwidget)
        self.R7Frame.setGeometry(QtCore.QRect(920, 330, 80, 100))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R7Frame.setFont(font)
        self.R7Frame.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.R7Frame.setFrameShadow(QtWidgets.QFrame.Raised)
        self.R7Frame.setObjectName("R7Frame")
        self.R7BLM3 = QtWidgets.QCheckBox(self.R7Frame)
        self.R7BLM3.setGeometry(QtCore.QRect(0, 50, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R7BLM3.setFont(font)
        self.R7BLM3.setChecked(True)
        self.R7BLM3.setObjectName("R7BLM3")
        self.R7BLM1 = QtWidgets.QCheckBox(self.R7Frame)
        self.R7BLM1.setGeometry(QtCore.QRect(0, 10, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R7BLM1.setFont(font)
        self.R7BLM1.setChecked(True)
        self.R7BLM1.setObjectName("R7BLM1")
        self.R7BLM4 = QtWidgets.QCheckBox(self.R7Frame)
        self.R7BLM4.setGeometry(QtCore.QRect(0, 70, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R7BLM4.setFont(font)
        self.R7BLM4.setChecked(True)
        self.R7BLM4.setObjectName("R7BLM4")
        self.R7BLM2 = QtWidgets.QCheckBox(self.R7Frame)
        self.R7BLM2.setGeometry(QtCore.QRect(0, 30, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R7BLM2.setFont(font)
        self.R7BLM2.setChecked(True)
        self.R7BLM2.setObjectName("R7BLM2")
        self.R8Frame = QtWidgets.QFrame(self.centralwidget)
        self.R8Frame.setGeometry(QtCore.QRect(1020, 330, 80, 100))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R8Frame.setFont(font)
        self.R8Frame.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.R8Frame.setFrameShadow(QtWidgets.QFrame.Raised)
        self.R8Frame.setObjectName("R8Frame")
        self.R8BLM3 = QtWidgets.QCheckBox(self.R8Frame)
        self.R8BLM3.setGeometry(QtCore.QRect(0, 50, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R8BLM3.setFont(font)
        self.R8BLM3.setChecked(True)
        self.R8BLM3.setObjectName("R8BLM3")
        self.R8BLM4 = QtWidgets.QCheckBox(self.R8Frame)
        self.R8BLM4.setGeometry(QtCore.QRect(0, 70, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R8BLM4.setFont(font)
        self.R8BLM4.setChecked(True)
        self.R8BLM4.setObjectName("R8BLM4")
        self.R8BLM2 = QtWidgets.QCheckBox(self.R8Frame)
        self.R8BLM2.setGeometry(QtCore.QRect(0, 30, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R8BLM2.setFont(font)
        self.R8BLM2.setChecked(True)
        self.R8BLM2.setObjectName("R8BLM2")
        self.R8BLM1 = QtWidgets.QCheckBox(self.R8Frame)
        self.R8BLM1.setGeometry(QtCore.QRect(0, 10, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R8BLM1.setFont(font)
        self.R8BLM1.setChecked(True)
        self.R8BLM1.setObjectName("R8BLM1")
        self.R9Frame = QtWidgets.QFrame(self.centralwidget)
        self.R9Frame.setGeometry(QtCore.QRect(1130, 330, 80, 100))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R9Frame.setFont(font)
        self.R9Frame.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.R9Frame.setFrameShadow(QtWidgets.QFrame.Raised)
        self.R9Frame.setObjectName("R9Frame")
        self.R9BLM4 = QtWidgets.QCheckBox(self.R9Frame)
        self.R9BLM4.setGeometry(QtCore.QRect(0, 70, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R9BLM4.setFont(font)
        self.R9BLM4.setChecked(True)
        self.R9BLM4.setObjectName("R9BLM4")
        self.R9BLM1 = QtWidgets.QCheckBox(self.R9Frame)
        self.R9BLM1.setGeometry(QtCore.QRect(0, 10, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R9BLM1.setFont(font)
        self.R9BLM1.setChecked(True)
        self.R9BLM1.setObjectName("R9BLM1")
        self.R9BLM2 = QtWidgets.QCheckBox(self.R9Frame)
        self.R9BLM2.setGeometry(QtCore.QRect(0, 30, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R9BLM2.setFont(font)
        self.R9BLM2.setChecked(True)
        self.R9BLM2.setObjectName("R9BLM2")
        self.R9BLM3 = QtWidgets.QCheckBox(self.R9Frame)
        self.R9BLM3.setGeometry(QtCore.QRect(0, 50, 81, 20))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.R9BLM3.setFont(font)
        self.R9BLM3.setChecked(True)
        self.R9BLM3.setObjectName("R9BLM3")
        self.ClearTime = QtWidgets.QPushButton(self.centralwidget)
        self.ClearTime.setGeometry(QtCore.QRect(890, 460, 131, 30))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.ClearTime.setFont(font)
        self.ClearTime.setObjectName("ClearTime")
        self.ClearBLM = QtWidgets.QPushButton(self.centralwidget)
        self.ClearBLM.setGeometry(QtCore.QRect(890, 500, 121, 30))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.ClearBLM.setFont(font)
        self.ClearBLM.setObjectName("ClearBLM")
        self.ClearALL = QtWidgets.QPushButton(self.centralwidget)
        self.ClearALL.setGeometry(QtCore.QRect(890, 540, 121, 30))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.ClearALL.setFont(font)
        self.ClearALL.setObjectName("ClearALL")
        self.FillALL = QtWidgets.QPushButton(self.centralwidget)
        self.FillALL.setGeometry(QtCore.QRect(890, 580, 111, 30))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        self.FillALL.setFont(font)
        self.FillALL.setObjectName("FillALL")
        self.InptMSTime = QtWidgets.QLabel(self.centralwidget)
        self.InptMSTime.setGeometry(QtCore.QRect(880, 50, 161, 21))
        font = QtGui.QFont()
        font.setFamily("Georgia")
        font.setPointSize(8)
        font.setBold(False)
        font.setUnderline(True)
        font.setWeight(50)
        self.InptMSTime.setFont(font)
        self.InptMSTime.setAlignment(QtCore.Qt.AlignCenter)
        self.InptMSTime.setObjectName("InptMSTime")
        self.SuperSpinnyTimeInpt = QtWidgets.QDoubleSpinBox(self.centralwidget)
        self.SuperSpinnyTimeInpt.setGeometry(QtCore.QRect(930, 70, 62, 22))
        self.SuperSpinnyTimeInpt.setDecimals(1)
        self.SuperSpinnyTimeInpt.setMaximum(10.5)
        self.SuperSpinnyTimeInpt.setObjectName("SuperSpinnyTimeInpt")
        GUIWindow.setCentralWidget(self.centralwidget)
        self.menubar = QtWidgets.QMenuBar(GUIWindow)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 1223, 26))
        self.menubar.setObjectName("menubar")
        GUIWindow.setMenuBar(self.menubar)
        self.statusbar = QtWidgets.QStatusBar(GUIWindow)
        self.statusbar.setObjectName("statusbar")
        GUIWindow.setStatusBar(self.statusbar)

        self.verticalLayout.addWidget(self.static_canvas)

        self.retranslateUi(GUIWindow)
        QtCore.QMetaObject.connectSlotsByName(GUIWindow)

    def retranslateUi(self, GUIWindow):
        _translate = QtCore.QCoreApplication.translate
        GUIWindow.setWindowTitle(_translate("GUIWindow", "Project 2: Waterfall"))
        self.ProtonPN.setText(_translate("GUIWindow", "Protons Lost"))
        self.VoltageMeV.setText(_translate("GUIWindow", "Voltage Lost (MeV)"))
        self.CoulombsC.setText(_translate("GUIWindow", "Coulombs Lost"))
        self.EnergyJ.setText(_translate("GUIWindow", "Energy Lost (J)"))
        self.R0BLM1.setText(_translate("GUIWindow", "BLM 1"))
        self.R0BLM3.setText(_translate("GUIWindow", "BLM 3"))
        self.R0BLM4.setText(_translate("GUIWindow", "BLM 4"))
        self.R0.setText(_translate("GUIWindow", "R0"))
        self.R1.setText(_translate("GUIWindow", "R1"))
        self.R1BLM1.setText(_translate("GUIWindow", "BLM 1"))
        self.R1BLM2.setText(_translate("GUIWindow", "BLM 2"))
        self.R1BLM3.setText(_translate("GUIWindow", "BLM 3"))
        self.R1BLM4.setText(_translate("GUIWindow", "BLM 4"))
        self.R2BLM1.setText(_translate("GUIWindow", "BLM 1"))
        self.R2BLM2.setText(_translate("GUIWindow", "BLM 2"))
        self.R2BLM3.setText(_translate("GUIWindow", "BLM 3"))
        self.R2BLM4.setText(_translate("GUIWindow", "BLM 4"))
        self.R2.setText(_translate("GUIWindow", "R2"))
        self.R3.setText(_translate("GUIWindow", "R3"))
        self.R4.setText(_translate("GUIWindow", "R4"))
        self.R5.setText(_translate("GUIWindow", "R5"))
        self.R6.setText(_translate("GUIWindow", "R6"))
        self.R7.setText(_translate("GUIWindow", "R7"))
        self.R8.setText(_translate("GUIWindow", "R8"))
        self.R9.setText(_translate("GUIWindow", "R9"))
        self.R3BLM3.setText(_translate("GUIWindow", "BLM 3"))
        self.R3BLM2.setText(_translate("GUIWindow", "BLM 2"))
        self.R3BLM1.setText(_translate("GUIWindow", "BLM 1"))
        self.R3BLM4.setText(_translate("GUIWindow", "BLM 4"))
        self.R4BLM3.setText(_translate("GUIWindow", "BLM 3"))
        self.R4BLM4.setText(_translate("GUIWindow", "BLM 4"))
        self.R4BLM1.setText(_translate("GUIWindow", "BLM 1"))
        self.R4BLM2.setText(_translate("GUIWindow", "BLM 2"))
        self.R5BLM3.setText(_translate("GUIWindow", "BLM 3"))
        self.R5BLM4.setText(_translate("GUIWindow", "BLM 4"))
        self.R5BLM2.setText(_translate("GUIWindow", "BLM 2"))
        self.R5BLM1.setText(_translate("GUIWindow", "BLM 1"))
        self.R6BLM3.setText(_translate("GUIWindow", "BLM 3"))
        self.R6BLM2.setText(_translate("GUIWindow", "BLM 2"))
        self.R6BLM1.setText(_translate("GUIWindow", "BLM 1"))
        self.R6BLM4.setText(_translate("GUIWindow", "BLM 4"))
        self.R7BLM3.setText(_translate("GUIWindow", "BLM 3"))
        self.R7BLM1.setText(_translate("GUIWindow", "BLM 1"))
        self.R7BLM4.setText(_translate("GUIWindow", "BLM 4"))
        self.R7BLM2.setText(_translate("GUIWindow", "BLM 2"))
        self.R8BLM3.setText(_translate("GUIWindow", "BLM 3"))
        self.R8BLM4.setText(_translate("GUIWindow", "BLM 4"))
        self.R8BLM2.setText(_translate("GUIWindow", "BLM 2"))
        self.R8BLM1.setText(_translate("GUIWindow", "BLM 1"))
        self.R9BLM4.setText(_translate("GUIWindow", "BLM 4"))
        self.R9BLM1.setText(_translate("GUIWindow", "BLM 1"))
        self.R9BLM2.setText(_translate("GUIWindow", "BLM 2"))
        self.R9BLM3.setText(_translate("GUIWindow", "BLM 3"))
        self.ClearTime.setText(_translate("GUIWindow", "Clear time interval"))
        self.ClearBLM.setText(_translate("GUIWindow", "Clear BLM Inputs"))
        self.ClearALL.setText(_translate("GUIWindow", "Clear ALL Inputs"))
        self.FillALL.setText(_translate("GUIWindow", "Fill ALL Inputs"))
        self.InptMSTime.setText(_translate("GUIWindow", "Input Time Interval (ms)"))

        # Connect button click events to functions
        self.ClearTime.clicked.connect(self.handle_ClearTime_click)
        self.ClearBLM.clicked.connect(self.handle_ClearBLM_click)
        self.ClearALL.clicked.connect(self.handle_ClearALL_click)
        self.FillALL.clicked.connect(self.handle_FillALL_click)

        # Connect checkbox state changed events to functions
        self.R0.stateChanged.connect(self.handle_R0_changed)
        self.R1.stateChanged.connect(self.handle_R1_changed)
        self.R2.stateChanged.connect(self.handle_R2_changed)
        self.R3.stateChanged.connect(self.handle_R3_changed)
        self.R4.stateChanged.connect(self.handle_R4_changed)
        self.R5.stateChanged.connect(self.handle_R5_changed)
        self.R6.stateChanged.connect(self.handle_R6_changed)
        self.R7.stateChanged.connect(self.handle_R7_changed)
        self.R8.stateChanged.connect(self.handle_R8_changed)
        self.R9.stateChanged.connect(self.handle_R9_changed)
        # ... and so on for other checkboxes

    def handle_ClearTime_click(self):
        self.SuperSpinnyTimeInpt.setValue(0)

    def handle_ClearBLM_click(self):
        self.R0.setChecked(False)
        self.R1.setChecked(False)
        self.R2.setChecked(False)
        self.R3.setChecked(False)
        self.R4.setChecked(False)
        self.R5.setChecked(False)
        self.R6.setChecked(False)
        self.R7.setChecked(False)
        self.R8.setChecked(False)
        self.R9.setChecked(False)

    def handle_ClearALL_click(self):
        self.SuperSpinnyTimeInpt.setValue(0)
        self.handle_ClearBLM_click()

    def handle_FillALL_click(self):
        self.SuperSpinnyTimeInpt.setValue(10.5)
        self.R0.setChecked(True)
        self.R1.setChecked(True)
        self.R2.setChecked(True)
        self.R3.setChecked(True)
        self.R4.setChecked(True)
        self.R5.setChecked(True)
        self.R6.setChecked(True)
        self.R7.setChecked(True)
        self.R8.setChecked(True)
        self.R9.setChecked(True)
        self.R0BLM1.setChecked(True)
        self.R0BLM3.setChecked(True)
        self.R0BLM4.setChecked(True)
        self.R1BLM1.setChecked(True)
        self.R1BLM2.setChecked(True)
        self.R1BLM3.setChecked(True)
        self.R1BLM4.setChecked(True)
        self.R2BLM1.setChecked(True)
        self.R2BLM2.setChecked(True)
        self.R2BLM3.setChecked(True)
        self.R2BLM4.setChecked(True)
        self.R3BLM1.setChecked(True)
        self.R3BLM2.setChecked(True)
        self.R3BLM3.setChecked(True)
        self.R3BLM4.setChecked(True)
        self.R4BLM1.setChecked(True)
        self.R4BLM2.setChecked(True)
        self.R4BLM3.setChecked(True)
        self.R4BLM4.setChecked(True)
        self.R5BLM1.setChecked(True)
        self.R5BLM2.setChecked(True)
        self.R5BLM3.setChecked(True)
        self.R5BLM4.setChecked(True)
        self.R6BLM1.setChecked(True)
        self.R6BLM2.setChecked(True)
        self.R6BLM3.setChecked(True)
        self.R6BLM4.setChecked(True)
        self.R7BLM1.setChecked(True)
        self.R7BLM2.setChecked(True)
        self.R7BLM3.setChecked(True)
        self.R7BLM4.setChecked(True)
        self.R8BLM1.setChecked(True)
        self.R8BLM2.setChecked(True)
        self.R8BLM3.setChecked(True)
        self.R8BLM4.setChecked(True)
        self.R9BLM1.setChecked(True)
        self.R9BLM2.setChecked(True)
        self.R9BLM3.setChecked(True)
        self.R9BLM4.setChecked(True)

    def handle_R0_changed(self, state):
        if state == QtCore.Qt.Checked:
            self.R0BLM1.setEnabled(True)
            self.R0BLM3.setEnabled(True)
            self.R0BLM4.setEnabled(True)
        else:
            self.R0BLM1.setChecked(False)
            self.R0BLM1.setEnabled(False)
            self.R0BLM3.setChecked(False)
            self.R0BLM3.setEnabled(False)
            self.R0BLM4.setChecked(False)
            self.R0BLM4.setEnabled(False)

    def handle_R1_changed(self, state):
        if state == QtCore.Qt.Checked:
            self.R1BLM1.setEnabled(True)
            self.R1BLM2.setEnabled(True)
            self.R1BLM3.setEnabled(True)
            self.R1BLM4.setEnabled(True)
        else:
            self.R1BLM1.setChecked(False)
            self.R1BLM1.setEnabled(False)
            self.R1BLM2.setChecked(False)
            self.R1BLM2.setEnabled(False)
            self.R1BLM3.setChecked(False)
            self.R1BLM3.setEnabled(False)
            self.R1BLM4.setChecked(False)
            self.R1BLM4.setEnabled(False)

    def handle_R2_changed(self, state):
        if state == QtCore.Qt.Checked:
            self.R2BLM1.setEnabled(True)
            self.R2BLM2.setEnabled(True)
            self.R2BLM3.setEnabled(True)
            self.R2BLM4.setEnabled(True)
        else:
            self.R2BLM1.setChecked(False)
            self.R2BLM1.setEnabled(False)
            self.R2BLM2.setChecked(False)
            self.R2BLM2.setEnabled(False)
            self.R2BLM3.setChecked(False)
            self.R2BLM3.setEnabled(False)
            self.R2BLM4.setChecked(False)
            self.R2BLM4.setEnabled(False)

    def handle_R3_changed(self, state):
        if state == QtCore.Qt.Checked:
            self.R3BLM1.setEnabled(True)
            self.R3BLM2.setEnabled(True)
            self.R3BLM3.setEnabled(True)
            self.R3BLM4.setEnabled(True)
        else:
            self.R3BLM1.setChecked(False)
            self.R3BLM1.setEnabled(False)
            self.R3BLM2.setChecked(False)
            self.R3BLM2.setEnabled(False)
            self.R3BLM3.setChecked(False)
            self.R3BLM3.setEnabled(False)
            self.R3BLM4.setChecked(False)
            self.R3BLM4.setEnabled(False)

    def handle_R4_changed(self, state):
        if state == QtCore.Qt.Checked:
            self.R4BLM1.setEnabled(True)
            self.R4BLM2.setEnabled(True)
            self.R4BLM3.setEnabled(True)
            self.R4BLM4.setEnabled(True)
        else:
            self.R4BLM1.setChecked(False)
            self.R4BLM1.setEnabled(False)
            self.R4BLM2.setChecked(False)
            self.R4BLM2.setEnabled(False)
            self.R4BLM3.setChecked(False)
            self.R4BLM3.setEnabled(False)
            self.R4BLM4.setChecked(False)
            self.R4BLM4.setEnabled(False)

    def handle_R5_changed(self, state):
        if state == QtCore.Qt.Checked:
            self.R5BLM1.setEnabled(True)
            self.R5BLM2.setEnabled(True)
            self.R5BLM3.setEnabled(True)
            self.R5BLM4.setEnabled(True)
        else:
            self.R5BLM1.setChecked(False)
            self.R5BLM1.setEnabled(False)
            self.R5BLM2.setChecked(False)
            self.R5BLM2.setEnabled(False)
            self.R5BLM3.setChecked(False)
            self.R5BLM3.setEnabled(False)
            self.R5BLM4.setChecked(False)
            self.R5BLM4.setEnabled(False)

    def handle_R6_changed(self, state):
        if state == QtCore.Qt.Checked:
            self.R6BLM1.setEnabled(True)
            self.R6BLM2.setEnabled(True)
            self.R6BLM3.setEnabled(True)
            self.R6BLM4.setEnabled(True)
        else:
            self.R6BLM1.setChecked(False)
            self.R6BLM1.setEnabled(False)
            self.R6BLM2.setChecked(False)
            self.R6BLM2.setEnabled(False)
            self.R6BLM3.setChecked(False)
            self.R6BLM3.setEnabled(False)
            self.R6BLM4.setChecked(False)
            self.R6BLM4.setEnabled(False)

    def handle_R7_changed(self, state):
        if state == QtCore.Qt.Checked:
            self.R7BLM1.setEnabled(True)
            self.R7BLM2.setEnabled(True)
            self.R7BLM3.setEnabled(True)
            self.R7BLM4.setEnabled(True)
        else:
            self.R7BLM1.setChecked(False)
            self.R7BLM1.setEnabled(False)
            self.R7BLM2.setChecked(False)
            self.R7BLM2.setEnabled(False)
            self.R7BLM3.setChecked(False)
            self.R7BLM3.setEnabled(False)
            self.R7BLM4.setChecked(False)
            self.R7BLM4.setEnabled(False)

    def handle_R8_changed(self, state):
        if state == QtCore.Qt.Checked:
            self.R8BLM1.setEnabled(True)
            self.R8BLM2.setEnabled(True)
            self.R8BLM3.setEnabled(True)
            self.R8BLM4.setEnabled(True)
        else:
            self.R8BLM1.setChecked(False)
            self.R8BLM1.setEnabled(False)
            self.R8BLM2.setChecked(False)
            self.R8BLM2.setEnabled(False)
            self.R8BLM3.setChecked(False)
            self.R8BLM3.setEnabled(False)
            self.R8BLM4.setChecked(False)
            self.R8BLM4.setEnabled(False)

    def handle_R9_changed(self, state):
        if state == QtCore.Qt.Checked:
            self.R9BLM1.setEnabled(True)
            self.R9BLM2.setEnabled(True)
            self.R9BLM3.setEnabled(True)
            self.R9BLM4.setEnabled(True)
        else:
            self.R9BLM1.setChecked(False)
            self.R9BLM1.setEnabled(False)
            self.R9BLM2.setChecked(False)
            self.R9BLM2.setEnabled(False)
            self.R9BLM3.setChecked(False)
            self.R9BLM3.setEnabled(False)
            self.R9BLM4.setChecked(False)
            self.R9BLM4.setEnabled(False)


    
    def waterfall(self, p): 
        self.fig.clear()
        self.ax = self.fig.add_subplot(projection="3d")
        x_data = np.linspace(-.5, 10.5, 2200)
        blm_iterator_list = np.linspace(1,38,39, dtype=int)
        #Graph colours
        colors = ['r', 'g', 'b', 'y']
        yticks = [3, 2, 1, 0]
        
        blm_iterator_list = np.linspace(1,38,39, dtype=int)

        # fig = plt.figure(figsize=(10,11), tight_layout = True)
        # ax = fig.add_subplot(projection='3d')


        x_data = np.linspace(-.5, 10.5, 2200)
        for i in blm_iterator_list:
        # fetch_stored_data(n, None, False) = R5IM loss data, n = glob file index not BLM index
        # fetch_stored_data(n, None, True) = cycle data, n = glob file index not BLM index
        #y data variable
            y=p[i]
            self.ax.plot(x_data, y, zs=i, zdir='y', alpha=0.8)
            self.ax.set_zlim(-0.15, 0.25)
    #ax.set_xlim(-0.5, 10.5);
    #ax.set_zlim(-0.01, 0.05);
        self.ax.set_title('All BLMs for in-cycle data')
        self.ax.set_xlabel('Time (ms)')
        self.ax.set_ylabel('Signal Index')
        self.ax.set_zlabel('BLM Signal (Volts)')
        # plt.show()
        self.static_canvas.draw()

if __name__ == "__main__":
    import sys
    data_queue = multiprocessing.Queue()
    app = QtWidgets.QApplication(sys.argv)
    MainWindow = QtWidgets.QMainWindow()
    ui = Ui_GUIWindow(data_queue)
    ui.setupUi(MainWindow)
    MainWindow.show()
    sys.exit(app.exec_())

    # data_queue = multiprocessing.Queue()

    # app = qt.QApplication(sys.argv)
    # window = gui(data_queue)
    # window.show()
    # app.exec()
